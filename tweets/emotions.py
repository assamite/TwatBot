#Encoding: utf-8
'''
.. py:module:: emotions
    :platform: Unix
  
Thesaurus Rex words in negative:emotion and positive:emotion categories mapped 
on the surface of the unit circle residing inside the LÃ¶vheim cube of emotion.  
'''


EMOTIONS = (
    ('hopelessness', (-0.988600657036, 0.0433096615276, -0.144197829823)),
    ('hostility', (-0.956721543631, 0.159799710452, 0.243203496052)),
    ('detestation', (-0.381963717793, -0.590855008993, -0.710629352502)),
    ('peace', (-0.51982127225, -0.694623738426, 0.497276288327)),
    ('compassion', (-0.865245040562, -0.323265599608, -0.383210610361)),
    ('dignity', (-0.366530680001, -0.680832808854, -0.634130859528)),
    ('love', (0.43579609597, -0.630567784316, 0.64223518443)),
    ('guilt', (-0.869107241769, 0.228945921409, -0.438447679177)),
    ('optimism', (0.364736838951, 0.298871422074, 0.881840638312)),
    ('worry', (-0.598616348565, -0.529314272196, 0.601236117079)),
    ('isolation', (-0.814122534896, -0.454067933158, -0.361976256477)),
    ('impatience', (-0.775585814887, 0.595715488912, 0.208781464734)),
    ('fatigue', (-0.890282831422, 0.394169891846, -0.228093350268)),
    ('frustration', (-0.755542907013, 0.640564797418, 0.137228480903)),
    ('melancholy', (-0.551690769548, 0.731549241915, -0.400590815483)),
    ('helplessness', (-0.890695403751, 0.0502193568244, -0.451818231081)),
    ('pity', (-0.522278618631, -0.55216101365, -0.64987941922)),
    ('attachment', (0.72080920374, 0.590468505619, 0.363016577687)),
    ('fearfulness', (-0.710374362534, -0.511384945844, 0.483584224535)),
    ('encouragement', (0.749709928604, -0.193330394799, 0.63289681734)),
    ('bereavement', (-0.814973824865, 0.366919494213, -0.44853957412)),
    ('unhappiness', (-0.83333176485, 0.548185473747, -0.0710693750126)),
    ('sadness', (-0.667337288928, 0.348284241138, -0.658300106472)),
    ('goodwill', (0.567258171047, 0.233703960519, 0.789683877395)),
    ('outrage', (-0.783497030756, 0.621394287482, -0.00124188634236)),
    ('loyalty', (0.152322313966, 0.419454243542, 0.894905609683)),
    ('confidence', (0.351903027021, 0.16607535068, 0.921185777935)),
    ('indignation', (-0.694836322879, 0.466557678717, -0.547290066453)),
    ('devotion', (0.779470076293, -0.012754507716, 0.626309606103)),
    ('disgust', (0.383843852794, -0.571798992948, -0.725058486148)),
    ('resentment', (-0.77429902602, 0.484186927761, 0.407460473284)),
    ('forgiveness', (-0.858954088639, 0.0857761086615, -0.504817128071)),
    ('aversion', (-0.374455419373, -0.519265036781, 0.768210231954)),
    ('wonder', (-0.365625745969, -0.510392034358, -0.778342973983)),
    ('fright', (0.431518081639, -0.670756374358, 0.603223036261)),
    ('distress', (-0.600000727723, 0.55732683932, -0.573921528526)),
    ('dissatisfaction', (-0.762329034847, 0.645101301956, 0.0519495220715)),
    ('humility', (0.452904426339, -0.888407573713, -0.0748970197836)),
    ('lust', (-0.671692159762, 0.292077842359, 0.680823160973)),
    ('excitement', (0.632016812873, 0.424370142484, 0.648432518011)),
    ('mirth', (0.696351803054, 0.165986900442, 0.698242447338)),
    ('dysphoria', (-0.993923219414, 0.0216133522912, 0.107932835196)),
    ('madness', (-0.82939219241, 0.41612937394, 0.372753182834)),
    ('cheerfulness', (0.657742239158, -0.235088688234, 0.715617534366)),
    ('passion', (0.608530232408, 0.0688436002395, 0.79053874981)),
    ('concern', (-0.68711402242, -0.0987765428082, 0.71980380298)),
    ('sensuality', (0.405029407219, 0.134707781554, 0.904325711719)),
    ('enthrallment', (0.00724669192192, -0.0145430887095, 0.999867983299)),
    ('conceit', (-0.575569126374, -0.800529198638, -0.166952636675)),
    ('boredom', (-0.240811737606, -0.405336591394, 0.881879784726)),
    ('amusement', (0.802893474838, -0.55639501862, 0.213978156169)),
    ('surprise', (0.605838379927, 0.555840022566, -0.569211495598)),
    ('affection', (0.525935463344, 0.626116591378, 0.575647376784)),
    ('humor', (0.750659367522, -0.100062997675, 0.653068074896)),
    ('jealousy', (-0.751613583426, 0.43310401114, 0.4974916449)),
    ('pride', (0.554898999921, -0.414318217703, 0.72140662207)),
    ('triumph', (0.305258839375, -0.885192289118, -0.351072146815)),
    ('cynicism', (-0.936220910836, -0.115715052814, 0.331813852432)),
    ('gravity', (-0.889830003684, 0.243473804141, 0.385905521132)),
    ('gaiety', (0.6925913152, -0.151571317386, 0.705225783601)),
    ('fury', (-0.77919503702, 0.596272511451, 0.193168802793)),
    ('protectiveness', (-0.683696947875, 0.234090522284, 0.691201932031)),
    ('contempt', (0.544878705871, -0.585728161151, -0.600024763758)),
    ('playfulness', (0.654830694838, -0.0231615564306, 0.755420613567)),
    ('embarrassment', (-0.58105474587, -0.341929516264, -0.738552359829)),
    ('restlessness', (-0.39138414593, 0.613869218677, 0.685553085235)),
    ('grudge', (-0.97344096495, -0.208124050658, 0.0953785473513)),
    ('anxiousness', (0.152527558091, 0.519152677118, 0.84096126062)),
    ('dread', (-0.51228795654, -0.308362061542, 0.801544689076)),
    ('benevolence', (0.502655974529, -0.862509928665, -0.0584259721729)),
    ('confusion', (-0.559511026711, 0.748085025953, 0.356813964041)),
    ('relaxation', (0.601875643692, -0.477901981518, 0.639808882083)),
    ('weakness', (-0.662639581379, 0.246595519597, -0.707177088786)),
    ('remorse', (-0.753653050168, 0.352164125525, -0.554966222995)),
    ('despondency', (-0.929817831671, 0.31260955923, -0.194201090071)),
    ('relief', (0.564182383906, 0.651956719064, -0.506607021425)),
    ('anxiety', (-0.731787216745, 0.314303114947, 0.60473218977)),
    ('calmness', (0.40932821118, 0.19583625379, 0.891122088849)),
    ('hopefulness', (0.407887985268, 0.0604190913378, 0.911030693707)),
    ('grief', (-0.765066377624, 0.573337715987, -0.29318475618)),
    ('joy', (0.657854801969, -0.393320483182, 0.642281913987)),
    ('hurt', (-0.764677919632, 0.370663653388, -0.52713957856)),
    ('admiration', (0.87877398767, -0.201865388691, -0.432442647578)),
    ('aggressiveness', (-0.231266973855, 0.285573524217, 0.930034058016)),
    ('insecurity', (-0.950237169614, -0.120888484285, 0.287115474769)),
    ('alienation', (-0.950027793985, 0.157392417895, -0.269582672746)),
    ('horror', (-0.5233786554, -0.206572182809, -0.82668175035)),
    ('indifference', (-0.334197978092, -0.478857681294, -0.811792481183)),
    ('pain', (-0.81987064315, 0.338740407157, -0.461591881493)),
    ('conflict', (-0.411597092673, 0.81147584079, 0.414843094575)),
    ('envy', (-0.604734486035, -0.766215250058, 0.217279524986)),
    ('gladness', (0.609881447041, -0.517653644932, 0.600066100062)),
    ('regret', (-0.732617341253, -0.226978050129, -0.64167966779)),
    ('sorrow', (-0.731246602934, 0.437370084671, -0.523436543176)),
    ('warmth', (0.73541902387, -0.0298104464813, 0.67695656922)),
    ('aggression', (-0.92483209137, -0.34730520304, -0.155128007506)),
    ('nervousness', (-0.223334111077, 0.477477984788, 0.849786237163)),
    ('apathy', (-0.916988467047, -0.308280881697, -0.253170000754)),
    ('despair', (-0.98459635361, 0.0429818217367, -0.169477383325)),
    ('self_esteem', (-0.203441367084, -0.809837674263, 0.550249535668)),
    ('sincerity', (0.441214825991, -0.886907016815, -0.136840859577)),
    ('expectation', (0.287943854518, 0.042766233805, 0.956691897055)),
    ('disapproval', (-0.218589508902, -0.190215965086, -0.957097964278)),
    ('shock', (0.279345663204, 0.220981225015, -0.934416020111)),
    ('anguish', (-0.697243589514, 0.465540912589, -0.545089933485)),
    ('irritability', (-0.700843645701, 0.234558730564, 0.67364707837)),
    ('dislike', (-0.023061774085, -0.277920991355, 0.960327067795)),
    ('enmity', (-0.902534508094, 0.394128425029, 0.173476933)),
    ('bitterness', (-0.893925312224, 0.447634065514, 0.022831547392)),
    ('anger', (-0.725512565131, 0.540584093957, 0.425911205766)),
    ('annoyance', (-0.650265742059, -0.331211029028, -0.683705871669)),
    ('elation', (0.776730547905, 0.0934826849771, 0.622856840341)),
    ('ecstasy', (0.540419089423, -0.307992191094, 0.782999372932)),
    ('shame', (-0.562615652685, -0.582317486882, -0.58683044555)),
    ('peacefulness', (0.620799098442, -0.286862718467, 0.729601439231)),
    ('desire', (0.0985416833898, 0.121280852343, 0.98771478246)),
    ('gratitude', (0.779150617165, -0.616502163701, 0.113355184809)),
    ('mercy', (-0.83719832001, -0.304629849089, -0.454202188477)),
    ('euphoria', (0.572615555521, 0.391762880092, 0.720161975779)),
    ('comfort', (0.551813672911, -0.505471767158, 0.663324930177)),
    ('hope', (-0.3059748248, -0.625453016538, 0.717765930295)),
    ('rage', (-0.605371982774, 0.581225602544, 0.543784480672)),
    ('irritation', (-0.913022432244, 0.30023312627, -0.276134221186)),
    ('serenity', (0.525823904124, -0.234426438432, 0.817651188965)),
    ('fear', (-0.63680422386, -0.526821423042, 0.562973861471)),
    ('happiness', (0.571159708978, -0.476826117395, 0.668141781818)),
    ('friendliness', (0.674930383767, -0.288270003425, 0.679241770059)),
    ('panic', (-0.81387503284, 0.229856679526, 0.533641581773)),
    ('suffering', (-0.854076179701, 0.00506677762899, -0.520123261384)),
    ('joviality', (0.743160916362, -0.0812700699448, 0.664158887709)),
    ('sympathy', (-0.766769745584, 0.568126436865, -0.298825214786)),
    ('aloofness', (-0.717090086276, -0.333704574717, -0.6119011889)),
    ('hatred', (-0.935914418946, 0.162736437402, 0.312379660592)),
    ('pessimism', (-0.550444283813, 0.183722038714, 0.814406104415)),
    ('depression', (-0.791527171448, 0.434492084229, -0.429768967705)),
    ('grievance', (-0.700875568707, -0.425600085509, -0.572396719421)),
    ('security', (-0.598419966413, -0.580197588264, 0.552507287165)),
    ('discomfort', (-0.69318835693, 0.0211516312088, -0.720446049551)),
    ('approval', (0.900630841241, 0.266029333942, 0.343645866102)),
    ('vengefulness', (-0.938918465957, -0.0549075123338, -0.339731186932)),
    ('misery', (-0.761514577307, -0.0966942147717, -0.640894513457)),
    ('disappointment', (0.254726362272, 0.485973861431, -0.836028639683)),
    ('feeling', (-0.137253007699, -0.24699327686, 0.959247586947)),
    ('expectancy', (0.393259641818, -0.0946140332409, 0.914546356852)),
    ('closeness', (0.253715977799, 0.624321707496, 0.738817032938)),
    ('care', (0.180879271904, 0.722768031948, 0.66700004572)),
    ('contentment', (0.60904222552, -0.514435485415, 0.603675160065)),
    ('feelings', (-0.789931619814, 0.56186336649, 0.245596403507)),
    ('spite', (0.289966273243, -0.130232938854, -0.948134453556)),
    ('resignation', (0.114740073836, 0.0983646104274, -0.988513590636)),
    ('anticipation', (0.596259076634, 0.432165694706, 0.676541148675)),
    ('empathy', (-0.909846676461, 0.402233554986, -0.10191757737)),
    ('discouragement', (-0.782253971763, -0.566874610796, 0.258325181304)),
    ('intimacy', (0.501706241815, -0.235314002265, 0.832417063293)),
    ('respect', (0.978829230662, -0.192803248533, -0.0687040359532)),
    ('agitation', (-0.880345152636, 0.382632556309, 0.280329697111)),
    ('spirit', (0.626410616498, -0.193240828785, 0.755160725693)),
    ('cruelty', (-0.489499800389, -0.508690596918, -0.708254066015)),
    ('terror', (-0.586037199333, -0.573708559112, 0.572205286763)),
    ('pleasure', (0.674532594675, -0.572589671943, 0.465990178335)),
    ('fulfillment', (0.659586400882, -0.538247008679, 0.524629333358)),
    ('zest', (0.665439284059, -0.00077584220657, 0.746451577331)),
    ('enthusiasm', (0.627785265133, 0.367991635449, 0.685906565883)),
    ('awe', (0.934362061874, -0.0564262447915, 0.35182895877)),
    ('hate', (-0.752047395536, -0.642021621381, 0.14910718476)),
    ('exhilaration', (0.686967726768, -0.0273174951572, 0.726174288197)),
    ('loneliness', (-0.959164858012, 0.175918319417, -0.221484807713)),
    ('moodiness', (-0.7548046277, 0.211625449239, 0.620874096123)),
    ('preference', (0.605561920982, 0.323911935768, 0.726894640043)),
    ('humiliation', (-0.612197344192, -0.486392608388, -0.623407284422)),
    ('discontentment', (-0.783421601917, 0.564844374222, 0.25923237946)),
    ('apprehension', (-0.648512973699, -0.0376843730677, 0.760270222336)),
    ('enjoyment', (0.599406741737, -0.533447847362, 0.596778813385)),
    ('ambition', (0.272580679101, -0.169857752507, 0.947020653045)),
    ('disdain', (0.33055942615, -0.56491151677, -0.756045927179)),
    ('joyfulness', (0.661074811149, -0.322834816097, 0.677316599221)),
    ('satisfaction', (0.880621381212, -0.384983002066, 0.27621381405)),
    ('tenderness', (-0.849665245335, 0.515181452515, -0.112503519303)),
    ('displeasure', (0.140998335814, -0.0531682751681, -0.98858110634)),
    ('sex', (-0.584180432187, -0.794732856497, 0.164720701353)),
    ('zeal', (0.510835785835, -0.121917934185, 0.850989316757)),
    ('delight', (0.933420311673, -0.193698835406, 0.302005435247)),
)


def get_point(emotion):
    '''Get point mapped for the emotion, or None if emotion does not exist.'''
    for e in EMOTIONS:
        s,p = e
        if s == emotion:
            return p
    return None


def plot_emotions(plot_labels = True):
    '''Plot all emotions into the 3D space.'''
    E = []
    X = []
    Y = []
    Z = []
    for e in EMOTIONS:
        s,p = e
        E.append(s)
        X.append(p[0])
        Y.append(p[1])
        Z.append(p[2])
    
    import matplotlib
    matplotlib.use('TkAgg')
    from matplotlib import pyplot as plt 
    from mpl_toolkits.mplot3d import Axes3D
    from mpl_toolkits.mplot3d import proj3d
    print plt.__file__
    fig = plt.figure()
    ax = fig.add_subplot(111, projection='3d')    
    ax.scatter(X, Y, Z)
    ax.set_xlabel('Serotonin')
    ax.set_ylabel('Noradrenaline')
    ax.set_zlabel('Dopamine')
    
    if plot_labels:
        labels = []
        for i in range(len(X)):
            x2, y2, _ = proj3d.proj_transform(X[i],Y[i],Z[i], ax.get_proj())
            label = plt.annotate(
                E[i], 
                xy = (x2, y2), xytext = (-5, 5),
                textcoords = 'offset points', ha = 'right', va = 'bottom',
                bbox = dict(boxstyle = 'round,pad=0.1', fc = 'yellow', alpha = 0.5),
                arrowprops = dict(arrowstyle = '->', connectionstyle = 'arc3,rad=0'))
            labels.append(label)
        
        def update_position(e):
            for i in range(len(X)):
                x2, y2, _ = proj3d.proj_transform(X[i],Y[i],Z[i], ax.get_proj())
                labels[i].xy = (x2, y2)
                labels[i].update_positions(fig.canvas.renderer)
            fig.canvas.draw()
        fig.canvas.mpl_connect('button_release_event', update_position)

    plt.show()
    
    
def plot_pairwise_distances(model):
    '''Plot emotions pairwise distances into a heatmap.'''
    from matplotlib import pyplot as plt
    import numpy as np
    import itertools
    amount = len(EMOTIONS)
    dists = np.eye(amount)
    emotions = map(lambda x: x[0], EMOTIONS)[:amount]
    for e1, e2 in itertools.combinations(emotions,2):
        i1 = emotions.index(e1)
        i2 = emotions.index(e2)
        sim = model.similarity(e1, e2)
        dists[i1][i2] = sim
        dists[i2][i1] = sim
    
    dists = np.asarray(dists)    
    fig, ax = plt.subplots()
    fig.set_size_inches(100, 100)
    heatmap = ax.pcolor(dists, cmap=plt.cm.Blues)
    
    # put the major ticks at the middle of each cell
    ax.set_xticks(np.arange(dists.shape[0])+0.5, minor=False)
    ax.set_yticks(np.arange(dists.shape[1])+0.5, minor=False)
    cbar = plt.colorbar(heatmap)
    
    # want a more natural, table-like display
    ax.invert_yaxis()
    ax.xaxis.tick_top()
    figure_title = "Emotion Similarity Heatmap"
    
    plt.text(0.5, 1.08, figure_title,
         horizontalalignment='center',
         fontsize=20,
         transform = ax.transAxes)
    
    ax.set_xticklabels(emotions, minor=False, rotation=90)
    ax.set_yticklabels(emotions, minor=False)
    plt.savefig('emotion_heatmap.pdf')
    
    #plt.show()
    
    
    

if __name__ == "__main__": 
    plot_emotions()